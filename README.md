# test-welbex-node

Данный проект представляет собой API на Node.js, использующий фреймворк Express и библиотеку TypeORM для работы с базой данных PostgreSQL. Также в проекте используются библиотеки для авторизации и аутентификации пользователей (jsonwebtoken, bcrypt), валидации запросов (express-validator) и обработки тел запросов (body-parser). Для разработки и запуска проекта используются TypeScript, ts-node и nodemon.
 
Для запуска проекта необходимо выполнить следующие шаги:
1. Установить все зависимости, выполнив команду `npm install`.
2. Создать базу данных в PostgreSQL (например, с помощью команды `createdb test_welbex`).
3. Настроить параметры подключения к базе данных в файле `src/data/data-source.ts`.
4. Запустить приложение командой `npm start`.
5. Приложение будет доступно по адресу `http://localhost:3000`.
6. Миграции базы данных выполняются автоматически при запуске приложения, но в случае необходимости их можно выполнить командой `npm run typeorm migration:run`.

Документация к эндпоинтам:

1. POST /register
    - Описание: Регистрация нового пользователя
    - Параметры запроса:
        - username: string - имя пользователя
        - password: string - пароль пользователя
    - Успешный ответ:
        - Код: 200
        - Тело ответа: { "message": "User has been registered" }
    - Ошибки:
        - Код: 400, Тело ответа: { "message": "Username already taken" } - если пользователь с таким именем уже зарегистрирован
        - Код: 422, Тело ответа: { "message": "Missing or invalid data", "errors": [{ "msg": "error message" }] } - если в запросе отсутствуют обязательные параметры или параметры имеют неверный формат
        
2. POST /login
    - Описание: Авторизация пользователя
    - Параметры запроса:
        - username: string - имя пользователя
        - password: string - пароль пользователя
    - Успешный ответ:
        - Код: 200
        - Тело ответа: { "token": "JWT token" }
    - Ошибки:
        - Код: 401, Тело ответа: { "message": "Invalid username or password" } - если введен неверный логин или пароль

3. GET /users
    - Описание: Получение списка всех пользователей
    - Успешный ответ:
        - Код: 200
        - Тело ответа: [{ "id": 1, "username": "john" }, { "id": 2, "username": "jane" }, ...]

4. GET /users/:id
    - Описание: Получение информации о пользователе по его id
    - Параметры запроса:
        - id: number - идентификатор пользователя
    - Успешный ответ:
        - Код: 200
        - Тело ответа: { "id": 1, "username": "john" }
    - Ошибки:
        - Код: 404, Тело ответа: { "message": "User not found" } - если пользователь с таким id не найден

5. DELETE /users/:id
    - Описание: Удаление пользователя по его id
    - Параметры запроса:
        - id: number - идентификатор пользователя
    - Успешный ответ:
        - Код: 200
        - Тело ответа: "User has been removed"
    - Ошибки:
        - Код: 404, Тело ответа: { "message": "User not found" } - если пользователь с таким id не найден

6. POST /createBlog
    - Описание: Создание нового блог поста
    - Параметры запроса:
        - message: string - текст блог поста
        - Authorization: Bearer JWT token - токен авторизации пользователя
    - Успешный ответ:
        - Код: 201
        - Тело ответа: { "message": "Blog post created successfully" }
    - Ошибки:
        - Код: 401, Тело ответа: { "message": "Unauthorized" } - если токен авторизации отсутствует или неверный
        
7. GET /getBlogs  
    - Описание: Получение списка всех блог постов
    - Параметры запроса:
        - page: number - номер страницы (по умолчанию 1)
    - Успешный ответ:
        - Код: 200
        - Тело ответа: { "blogs": [{ "id": 1, "message": "Lorem ipsum", "author": {"id": 1, "username": "john" } }, { "id": 2, "message": "Dolor sit amet", "author": { "id": 2, "username": "jane" } }, ...], "total": 100 }
    - Ошибки:
        - Код: 401, Тело ответа: { "message": "Unauthorized" } - если токен авторизации отсутствует или неверный
        
8. PUT /updateBlog/:id  
    - Описание: Обновление блог поста по его id
    - Параметры запроса:
        - id: number - идентификатор блог поста
        - message: string - новый текст блог поста
        - Authorization: Bearer JWT token - токен авторизации пользователя
    - Успешный ответ:
        - Код: 200
        - Тело ответа: { "message": "Blog post updated successfully" }
    - Ошибки:
        - Код: 400, Тело ответа: { "message": "Invalid blog post ID" } - если передан неверный id блог поста
        - Код: 401, Тело ответа: { "message": "Unauthorized" } - если токен авторизации отсутствует или неверный
        - Код: 403, Тело ответа: { "message": "Unauthorized" } - если пользователь не является автором блог поста

9. DELETE /deleteBlog/:id
    - Описание: Удаление блог поста по его id
    - Параметры запроса:
        - id: number - идентификатор блог поста
        - Authorization: Bearer JWT token - токен авторизации пользователя
    - Успешный ответ:
        - Код: 200
        - Тело ответа: { "message": "Blog post deleted successfully" }
    - Ошибки:
        - Код: 400, Тело ответа: { "message": "Invalid blog post ID" } - если передан неверный id блог поста
        - Код: 401, Тело ответа: { "message": "Unauthorized" } - если токен авторизации отсутствует или неверный
        - Код: 403, Тело ответа: { "message": "Unauthorized" } - если пользователь не является автором блог поста
